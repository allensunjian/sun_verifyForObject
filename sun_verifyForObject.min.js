(function(q){var s="1.0.0",_name="sun_verifyForObject",_facName="SunVerifyForObject";var u={actionTypeMap:{textarea:"书写",max:"小于",min:"大于",select:"选择",input:"输入",empty:"非空",type:"类型"},rulesFn:{Array:{empty:function(a){return a.length>0},max:function(a,b,c,d){return c?a.length<=b:a.length<b},min:function(a,b,c){return c?a.length>=b:a.length>b}},String:{empty:function(a,b){return a||(b?{across:false,text:b}:false)},max:function(a,b,c){return c?a.length<=b:a.length<b},min:function(a,b,c){return c?a.length>=b:a.length>b}},Number:{empty:function(a,b){return(a>0)||(b?{across:false,text:b}:false)},max:function(a,b,c){b=parseFloat(b);return c?a<=b:a<b},min:function(a,b,c){b=parseFloat(b);return c?a>=b:a>b},type:function(a,b){return!isNaN(a)||{across:false,text:b}}},Object:{empty:function(a){return Object.keys(a).length>0}},Date:{}}};var v={_logger:{warn:console.warn,log:console.log,error:console.error},createLogger:function(a,b,c){v._logger[b]("["+a+" "+b+"]: "+c)},typeOf:function(a,b){var c=Object.prototype.toString.call(a).replace("[object ","").replace("]","");if(!b)return c;if(this.typeOf(b)=="String")return c==b;if(this.typeOf(b)=="Function")return c==b.name},betterForEach:function(c,d){var e=this.typeOf(c);if(e=="HTMLCollection"){c=Array.prototype.forEach.call(c,function(a,b){d(a,b,e)});return};if(e!=="Array"&&e!=="Object"){this.createLogger("betterForEach","error","params 1 must be Object or Array");return}for(var f in c){if(d(c[f],f,e)=="break"){break}}},merge:function(){var e=null;var f=Array.prototype.slice.call(arguments,0);function _merge(c,d){if(!e){e=d;return};v.betterForEach(d,function(o,b){(v.typeOf(o,"Object"))?v.betterForEach(o,function(a,k){e[b][k]=a}):e[b]=o})}v.betterForEach(f,function(a,b){var c=v.typeOf(a);if(c!=="Object"){v.createLogger("merge","error","arguments "+(b+1)+"must be object got "+c);return false};_merge(e,a)});return e},_noop:function(){},_timeoutShell:function(a,b){var c=this;var d=setTimeout(function(){a.call(c);clearTimeout(d)},b||200)},_scrollAnimation(rect,el){function getPos(a){var l=0,t=0;while(a){l+=a.offsetLeft;t+=a.offsetTop;a=a.offsetParent}return{left:l,top:t}}window.scroll({top:getPos(el).top-300,behavior:'smooth'})},_computedTarPos(tar){return{top:tar.offsetTop,left:tar.offsetLeft}}};window._sun_utils=v;var w={_proxyCenter:function(j,k,l){var m=this;var n=v.typeOf(j);var o=n=="Array";var p=n=="Object";if(!o&&!p)return;v.betterForEach(j,function(g,h){var i=v.typeOf(g);if(i=="Object"){j[h]=w._proxy_Object(g,w._proxyHandler(m,o?h:""));w._proxyCenter.call(m,j[h],k)}if(i=="Array"){j[h]=w._proxy_Array(g,function(a,c,d,e,b,f){k.call(m,"").apply(m,[d,c,d,d,f])},l||h);w._proxyCenter.call(m,j[h],k,h)}});return o?w._proxy_Array.call(this,j,w._proxy_Array_reload.bind(m)):w._proxy_Object(j,w._proxyHandler(m))},_proxy_Object:function(a,b){if(!v.typeOf(a,"Object"))return a;return new Proxy(a,b)},_proxy_Array:function(f,g,h){var i=this;if(!v.typeOf(f,"Array"))return f;return new Proxy(f,{set:function(a,b,c,d){if(v.typeOf(c,"Object")){b!=="__proto__"&&(c=w._proxy_Object(c,w._proxyHandler(i,b)))}var r=Reflect.set(a,b,c,d);var e=v.typeOf(a,"Array")?'modify':'create';if(b!=='length'){g(c,h,f,e,true,b)}else{}return true}})},_proxy_Array_reload:function(){var a=this;v._timeoutShell(function(){w.requireEngine._initRequire.call(a)},200)},_proxyHandler:function(a,b){return{set:x.handler_set.call(a,b),get:x.handler_get.bind(a)}},_validate:{validateTypeCenter:function(a,b,c,d,e,f){var g=a.rules;var h=a.type.name;var i=a.actionType;var j=this.validateTypeRulerMap[h].call(this,g,b,c||this._curObj,d);if(j){var k=j.handleErr;j.labelText=a.labelText;j.text=(k?"":(j.labelText+this.actionTypeMap[i]+"必须"))+j.text;w.requireEngine.goRequire.call(this,d,e,j.text,f)}else{this.requireErrList&&this.requireErrList.indexOf(d)>=0&&w.requireEngine.clearRequire.call(this,d,e)};return j},validateTypeRulerMap:function(h){var i={};v.betterForEach(h,function(f,g){i[g]=(function(e){return function(a,b,c,d){return w._validate.validateLoop.apply(this,[e,a,b,c,d])}})(h[g])});return i},validateLoop:function(f,g,h,i,j){var k="",_this=this,actionTypeMap=_this.actionTypeMap,ruleMap=_this.rules,retObj={};v.betterForEach(g,function(a,b){var c=[],b,defaultValue,equal,across=true,handleFn=false;var d=v.typeOf(a);if(d=="String"){c=a.split(":");b=c[0];defaultValue=c[1];if(defaultValue){var e=new RegExp("=","g");equal=defaultValue.indexOf("=")>=0;defaultValue=defaultValue.replace(e,"")}if(!f[b]){v.createLogger("validateLoop","warn"," options config rulesFn not include verify type ["+b+"] ! please check it");return}across=f[b].call(this,h,defaultValue,equal,i)}else if(d=="Function"){across=a(h,i)}else{v.createLogger("svf","warn","options config rulesFn "+a+" must be String or Function, got "+d+" at params "+b+", has been skipped!");across=true};if(v.typeOf(across,"Object")){k=across.text;retObj.handleErr=true;retObj.targetKey=j;!across.across&&(retObj.text=k);across=across.across};if(!across){if(!retObj.handleErr){retObj.text=actionTypeMap[b]+(equal?"等于":"")+(defaultValue?defaultValue:"");retObj.errType=b;v.typeOf(equal,Boolean)&&(retObj.equal=equal);defaultValue&&(retObj.defaultValue=defaultValue)};return"break"}});return retObj.text?retObj:null}},_eventLoop:{createLoop:function(){this.eventLoop={}},mounteLoop:function(a,b){this.eventLoop[a]=b},getEvents:function(){return this.eventLoop},$emit:function(a,b){var c=w._eventLoop.getEvents.call(this);c[a](b)}},_mounteRuleConfigs:function(){var a=v.typeOf(this.outSideConfigs);if(a=="Undefined"){this.outSideConfigs={}}else if(a!=="Object"){this.outSideConfigs={};v.createLogger("svf","warn","outSideRulesConfig must be object")}var b=this.outSideConfigs.rulesFn||{};var c=this.outSideConfigs.actionTypeMap||{};this.mergeRulesFn=this.config.switchOutsideRules?v.merge(u.rulesFn,b):u.rulesFn;this.actionTypeMap=this.config.switchOutsideRules?v.merge(u.actionTypeMap,c):u.actionTypeMap;this.validateTypeRulerMap=w._validate.validateTypeRulerMap(this.mergeRulesFn)},requireEngine:{_initRequire:function(){var a=this.config||{};var b=a.swicthRequire;var c={},mainClass=void 0,requireClass=void 0;if(!b)return;c=a.requireOption||null;if(!c){v.createLogger("svf","warn","you opened the function require set true, you must set option requireOption!");return}requireClass=c.requireClass;mainClass=c.mainClass;if(!mainClass||!requireClass){v.createLogger("svf","warn","you must set mainClass and requireClass, call me how to do it");return};w.requireEngine.getRquiredEls.call(this,mainClass,requireClass)},getRquiredEls:function(g,h){var i={};var j={};var k=document.getElementsByClassName(g);var l=document.getElementsByClassName(h);v.betterForEach(k,function(a,b){var c=a.dataset;var d=c.verflykey;var e=c.vervaluetype;var f=v.typeOf(i[d],"Array");e=="array"?f?i[d].push(a):i[d]=[a]:i[d]=a});v.betterForEach(l,function(a,b){var c=a.dataset;var d=c.requirekey;var e=c.vervaluetype;var f=v.typeOf(j[d],"Array");e=="array"?f?j[d].push(a):j[d]=[a]:j[d]=a});this.mainElsMap=i;this.requiredElsMap=j;this.requireErrList?"":this.requireErrList=[];this._requireInited=true},goRequire:function(a,b,c,d){if(!this._requireInited)return;var e=void 0,rEl=void 0;var f=this.mainElsMap[a];var g=this.requiredElsMap[a];(b&&b>=0)?e=(f?f[b]:void 0):e=f;(b&&b>=0)?rEl=(f?g[b]:void 0):rEl=g;if(e){!d&&w.requireEngine.setTip(e);!d&&this.requireErrList.indexOf(a)==-1&&this.requireErrList.push(a);!d&&w.requireEngine.scrollToEl(e)};if(rEl){!d&&w.requireEngine.setRequire(rEl,c)}},clearRequire:function(a,b){var c=void 0,rEl=void 0;var d=this.mainElsMap[a];var e=this.requiredElsMap[a];(b&&b>=0)?c=(d?d[b]:void 0):c=d;(b&&b>=0)?rEl=(d?e[b]:void 0):rEl=e;w.requireEngine.setTip(c,true);w.requireEngine.setRequire(rEl,"",true)},setTip:function(a,b){if(!a)return;if(!b){a.style.borderColor="#F56C6C"}else{a.style.borderColor="#ddd"}},setRequire:function(a,b,c){if(!a)return;if(!c){a.innerText=b;a.style.color="#F56C6C"}else{a.innerText=""}},scrollToEl:function(a){var b=v._computedTarPos(a);v._scrollAnimation(b,a)},resetRequire:function(){function clearEls(a){if(a){w.requireEngine.setTip(a,true,"#ddd")}}function clearRls(){}w.requireEngine._initRequire.call(this);v.betterForEach(this.mainElsMap,function(b){if(v.typeOf(b,Array)){v.betterForEach(b,function(a){clearEls(a)})}else{clearEls(b)}})}}};var x={createFac:function(){var c=this;return function(a,b){c.init.call(this,b,a);return}},init:function(a,b){w._eventLoop.createLoop.call(this);this.rules=a.rules;this.config=a.config||{};this.outSideConfigs=this.config.outSideRulesConfig;w._mounteRuleConfigs.call(this);b=w._proxyCenter.call(this,b,x.handler_set.bind(this));this._curObj=b},handler_set:function(h){return function(a,b,c,d,e,f){var g=this.rules&&this.rules[b],ret;var r=Reflect.set(a,b,c,d);if(!g||"__proto__"==b)return;this.startTest&&(ret=w._validate.validateTypeCenter.call(this,g,c,h>=0?this._curObj[h]:this._curObj,b,h));ret&&w._eventLoop.$emit.call(this,"tirrger",ret);if(e)return;return r}.bind(this)},handler_get:function(a,b){return a[b]},_testObject:function(d,e,f){var g=true,_this=this;v.betterForEach(d,function(a,b){var c=_this.rules[b],ret;if(!c)return;ret=w._validate.validateTypeCenter.call(_this,c,a,d,b,e,f);if(ret){g=false;!f&&w._eventLoop.$emit.call(_this,"tirrger",ret);return"break"}});return g}};var y={test:function(c){var d=this,curType=v.typeOf(this._curObj),across;this.startTest=true;w.requireEngine._initRequire.call(this);if(curType=="Object"){across=x._testObject.call(d,this._curObj,-1,c)}else if(curType=="Array"){_sun_utils.betterForEach(this._curObj,function(a,b){across=x._testObject.call(d,a,b,c);if(!across)return"break"})}else{_sun_utils.createLogger("svf","warn","you must insert Object/Array got "+curType)}return across},$on:function(a,b){w._eventLoop.mounteLoop.apply(this,[a,b])},getObject:function(){return this._curObj}};q[_facName]=x.createFac();q[_facName].prototype=y})(window);